

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html class="pageview">


<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<base target="_top">
<style type="text/css">
  

/* default css */

table {
  font-size: 1em;
  line-height: inherit;
  border-collapse: collapse;
}


tr {
  
  text-align: left;
  
}


div, address, ol, ul, li, option, select {
  margin-top: 0px;
  margin-bottom: 0px;
}

p {
  margin: 0px;
}


pre {
  font-family: Courier New;
  white-space: pre-wrap;
  margin:0;
}

body {
  margin: 6px;
  padding: 0px;
  font-family: Verdana, sans-serif;
  font-size: 10pt;
  background-color: #ffffff;
  color: #000;
}


img {
  -moz-force-broken-image-icon: 1;
}

@media screen {
  html.pageview {
    background-color: #f3f3f3 !important;
    overflow-x: hidden;
    overflow-y: scroll;
  }

  

  body {
    min-height: 1100px;
    
    counter-reset: __goog_page__;
  }
  
  * html body {
    height: 1100px;
  }
  /* Prevent repaint errors when scrolling in Safari. This "Star-7" css hack
     targets Safari 3.1, but not WebKit nightlies and presumably Safari 4.
     That's OK because this bug is fixed in WebKit nightlies/Safari 4 :-). */
  html*#wys_frame::before {
    content: '\A0';
    position: fixed;
    overflow: hidden;
    width: 0;
    height: 0;
    top: 0;
    left: 0;
  }
  
  .pageview body {
    border-top: 1px solid #ccc;
    border-left: 1px solid #ccc;
    border-right: 2px solid #bbb;
    border-bottom: 2px solid #bbb;
    width: 648px !important;
    margin: 15px auto 25px;
    padding: 40px 50px;
  }
  /* IE6 */
  * html {
    overflow-y: scroll;
  }
  * html.pageview body {
    overflow-x: auto;
  }
  

  
    
    
    .writely-callout-data {
      display: inline-block;
      width: 1px;
      height: 1px;
      overflow: hidden;
      margin-left: -1px;
    }
    

    .writely-footnote-marker {
      background-image: url('MISSING');
      background-color: transparent;
      background-repeat: no-repeat;
      width: 7px;
      overflow: hidden;
      height: 16px;
      vertical-align: top;

      
      -moz-user-select: none;
    }
    .editor .writely-footnote-marker {
      cursor: move;
    }
    .writely-footnote-marker-highlight {
      background-position: -15px 0;
      -moz-user-select: text;
    }
    .writely-footnote-hide-selection ::-moz-selection, .writely-footnote-hide-selection::-moz-selection {
      background: transparent;
    }
    .writely-footnote-hide-selection ::selection, .writely-footnote-hide-selection::selection {
      background: transparent;
    }
    .writely-footnote-hide-selection {
      cursor: move;
    }

    /* Comments */
    .writely-comment-yellow {
      background-color: #ffffd7;
    }
    .writely-comment-orange {
      background-color: #ffe3c0;
    }
    .writely-comment-pink {
      background-color: #ffd7ff;
    }
    .writely-comment-green {
      background-color: #d7ffd7;
    }
    .writely-comment-blue {
      background-color: #d7ffff;
    }
    .writely-comment-purple {
      background-color: #eed7ff;
    }

  


  
  .br_fix span+br:not(:-moz-last-node) {
    
    position:relative;
    
    left: -1ex
    
  }

  
  #cb-p-tgt {
    font-size: 8pt;
    padding: .4em;
    background-color: #ddd;
    color: #333;
  }
  #cb-p-tgt-can {
    text-decoration: underline;
    color: #36c;
    font-weight: bold;
    margin-left: 2em;
  }
  #cb-p-tgt .spin {
    width: 16px;
    height: 16px;
    background: url(//ssl.gstatic.com/docs/clipboard/spin_16o.gif) no-repeat;
  }
}

h6 { font-size: 8pt }
h5 { font-size: 8pt }
h4 { font-size: 10pt }
h3 { font-size: 12pt }
h2 { font-size: 14pt }
h1 { font-size: 18pt }

blockquote {padding: 10px; border: 1px #DDD dashed }

.webkit-indent-blockquote { border: none; }

a img {border: 0}

.pb {
  border-width: 0;
  page-break-after: always;
  /* We don't want this to be resizeable, so enforce a width and height
     using !important */
  height: 1px !important;
  width: 100% !important;
}

.editor .pb {
  border-top: 1px dashed #C0C0C0;
  border-bottom: 1px dashed #C0C0C0;
}

div.google_header, div.google_footer {
  position: relative;
  margin-top: 1em;
  margin-bottom: 1em;
}


/* Table of contents */
.editor div.writely-toc {
  background-color: #f3f3f3;
  border: 1px solid #ccc;
}
.writely-toc > ol {
  padding-left: 3em;
  font-weight: bold;
}
ol.writely-toc-subheading {
  padding-left: 1em;
  font-weight: normal;
}
/* IE6 only */
* html writely-toc ol {
  list-style-position: inside;
}
.writely-toc-none {
  list-style-type: none;
}
.writely-toc-decimal {
  list-style-type: decimal;
}
.writely-toc-upper-alpha {
  list-style-type: upper-alpha;
}
.writely-toc-lower-alpha {
  list-style-type: lower-alpha;
}
.writely-toc-upper-roman {
  list-style-type: upper-roman;
}
.writely-toc-lower-roman {
  list-style-type: lower-roman;
}
.writely-toc-disc {
  list-style-type: disc;
}

/* Ordered lists converted to numbered lists can preserve ordered types, and
   vice versa. This is confusing, so disallow it */
ul[type="i"], ul[type="I"], ul[type="1"], ul[type="a"], ul[type="A"] {
  list-style-type: disc;
}

ol[type="disc"], ol[type="circle"], ol[type="square"] {
  list-style-type: decimal;
}

/* end default css */


  /* default print css */
  @media print {
    body {
      padding: 0;
      margin: 0;
    }

    div.google_header, div.google_footer {
      display: block;
      min-height: 0;
      border: none;
    }

    div.google_header {
      flow: static(header);
    }

    /* used to insert page numbers */
    div.google_header::before, div.google_footer::before {
      position: absolute;
      top: 0;
    }

    div.google_footer {
      flow: static(footer);
    }

    /* always consider this element at the start of the doc */
    div#google_footer {
      flow: static(footer, start);
    }

    span.google_pagenumber {
      content: counter(page);
    }

    span.google_pagecount {
      content: counter(pages);
    }

    .endnotes {
      page: endnote;
    }

    /* MLA specifies that endnotes title should be 1" margin from the top of the page. */
    @page endnote {
      margin-top: 1in;
    }

    callout.google_footnote {
      
      display: prince-footnote;
      footnote-style-position: inside;
      /* These styles keep the footnote from taking on the style of the text
         surrounding the footnote marker. They can be overridden in the
         document CSS. */
      color: #000;
      font-family: Verdana;
      font-size: 10.0pt;
      font-weight: normal;
    }

    /* Table of contents */
    #WritelyTableOfContents a::after {
      content: leader('.') target-counter(attr(href), page);
    }

    #WritelyTableOfContents a {
      text-decoration: none;
      color: black;
    }

    /* Comments */
    .writely-comment-yellow {
      background-color: #ffffd7;
    }
    .writely-comment-orange {
      background-color: #ffe3c0;
    }
    .writely-comment-pink {
      background-color: #ffd7ff;
    }
    .writely-comment-green {
      background-color: #d7ffd7;
    }
    .writely-comment-blue {
      background-color: #d7ffff;
    }
    .writely-comment-purple {
      background-color: #eed7ff;
    }
  }

  @page {
    @top {
      content: flow(header);
    }
    @bottom {
      content: flow(footer);
    }
    @footnotes {
      border-top: solid black thin;
      padding-top: 8pt;
    }
  }
  /* end default print css */


/* custom css */


/* end custom css */

/* ui edited css */

body {
  font-family: Verdana;
  
  font-size: 10.0pt;
  line-height: normal;
  background-color: #ffffff;
}
/* end ui edited css */


/* editor CSS */
.editor a:visited {color: #551A8B}
.editor table.zeroBorder {border: 1px dotted gray}
.editor table.zeroBorder td {border: 1px dotted gray}
.editor table.zeroBorder th {border: 1px dotted gray}


.editor div.google_header, .editor div.google_footer {
  border: 2px #DDDDDD dashed;
  position: static;
  width: 100%;
  min-height: 2em;
}

.editor .misspell {background-color: yellow}

.editor .writely-comment {
  font-size: 9pt;
  line-height: 1.4;
  padding: 1px;
  border: 1px dashed #C0C0C0
}


/* end editor CSS */

</style>

  
  <title>Single Sign-On Design Doc</title>

</head>

<body 
    
    >
    
<div style=TEXT-ALIGN:center>
  <font size=4><br>
  </font>
</div>
<div style=TEXT-ALIGN:center>
  <font size=4>Single Sign-On<br>
  </font>
</div>
<div style=TEXT-ALIGN:center>
  <font size=1><a href=http://go.kzsu.fm/ssodesigndoc id=t2w. title=http://go.kzsu.fm/ssodesigndoc>go.kzsu.fm/ssodesigndoc</a><br>
  <br>
  </font>
</div>
<div style=TEXT-ALIGN:center>
  <b>Status</b>: Draft
</div>
<div style=TEXT-ALIGN:center>
  <br>
</div>
<div style=TEXT-ALIGN:center>
  <b>Authors:</b>
</div>
<div style=TEXT-ALIGN:center>
  Brie Bunge &lt;bbunge@kzsu.stanford.edu&gt;
</div>
<div style=TEXT-ALIGN:center>
  Truc Nguyen &lt;truc@kzsu.stanford.edu&gt;
</div>
<div style=TEXT-ALIGN:center>
  <div style=TEXT-ALIGN:center>
    Nick McGee &lt;brndmg@kzsu.stanford.edu&gt;
  </div>
</div>
<div style=TEXT-ALIGN:center>
  <br>
</div>
<div style=TEXT-ALIGN:center>
  <b>To be reviewed by:</b>
</div>
<div style=TEXT-ALIGN:center>
  Andrew Widdowson &lt;apw@kzsu.stanford.edu&gt;
</div>
<div style=TEXT-ALIGN:center>
  <div style=TEXT-ALIGN:center>
    Brennan Saeta &lt;saeta@kzsu.stanford.edu&gt;
  </div>
  <div style=TEXT-ALIGN:center>
    Jim Mason &lt;jmason@kzsu.stanford.edu&gt;
  </div>
  <div style=TEXT-ALIGN:center>
    <br>
  </div>
  <div style=TEXT-ALIGN:center>
    <br>
  </div>
</div>
<div class=writely-toc id=WritelyTableOfContents toctype=none+none>
  <ol class=writely-toc-none>
    <li>
      <a href=#Objective_00020163808949291706_9850984867662191 target=_self>Objective</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0>
      <li>
        <a href=#Goals_and_motivations_62294934 target=_self>Goals and motivations</a>
      </li>
    </ol>
    <li>
      <a href=#Background_1717556386720389_93_9973794433753937 target=_self>Background</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0>
      <li>
        <a href=#Frontend_Perspective_1638515768572688 target=_self>Frontend Perspective</a>
      </li>
      <li>
        <a href=#Backend_perspective_33480621431954205 target=_self>Backend perspective</a>
      </li>
    </ol>
    <li>
      <a href=#Overview_8263451410457492_9812_01892273989506066 target=_self>Overview</a>
    </li>
    <li>
      <a href=#Existing_Resources_Standards_A target=_self>Existing Resources, Standards, APIs</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0>
      <li>
        <a href=#Technologies_Involved_3511500572785735 target=_self>Technologies Involved</a>
      </li>
      <li>
        <a href=#Existing_Resources_3821999980136752 target=_self>Existing Resources</a>
      </li>
    </ol>
    <li>
      <a href=#Detailed_Design_80067973327822 target=_self>Detailed Design</a>
    </li>
    <li>
      <a href=#Project_Information_4506208635 target=_self>Project Information</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0>
      <li>
        <a href=#Who_is_working_on_the_project_5034892521798611 target=_self>Who is working on the project</a>
      </li>
      <li>
        <a href=#Where_the_code_will_be_located_4731373928952962 target=_self>Where the code will be located</a>
      </li>
      <li>
        <a href=#Email_list_6867748091463 target=_self>Email list</a>
      </li>
    </ol>
    <li>
      <a href=#UI_Mocks_530787083087489_16353_9052909591700882 target=_self>UI / Mocks</a>
    </li>
    <li>
      <a href=#Testing_Plan_2774864013772458__7110875067301095 target=_self>Testing Plan</a>
    </li>
    <li>
      <a href=#Monitoring_5899063085671514_51_3189953579567373 target=_self>Monitoring</a>
    </li>
    <li>
      <a href=#Caveats_15509056905284524_9073_2750521623529494 target=_self>Caveats</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0>
      <li>
        <a href=#Possible_alternative_solutions_6426903980318457 target=_self>Possible alternative solutions</a>
      </li>
    </ol>
    <li>
      <a href=#Work_Estimates_098250156966969 target=_self>Work Estimates</a>
    </li>
    <li>
      <a href=#Launch_Plans_7571198488585651__6688848624471575 target=_self>Launch Plans</a>
    </li>
    <li>
      <a href=#Future_Extension_Ideas_3603024 target=_self>Future Extension Ideas</a>
    </li>
    <li>
      <a href=#References_3130921598058194_75_5179974548518658 target=_self>References</a>
    </li>
  </ol>
</div>
<br>
<h1>
  <a id=Objective_00020163808949291706_9850984867662191 name=Objective_00020163808949291706_9850984867662191></a>Objective
</h1>
<i>What are your goals and motivation for this project? What problem(s) are you trying to address?<br>
</i>
<h2>
  <a id=Goals_and_motivations_62294934 name=Goals_and_motivations_62294934></a>Goals and motivations
</h2>
<ul>
  <li>
    Create a more secure and unified mechanism for logging into KZSU applications
  </li>
  <li>
    Reduce password fatigue from different user name and password combinations
  </li>
  <li>
    Reduce time spent re-entering passwords when using KZSU applications
  </li>
  <li>
    One master station list of everyone involved
  </li>
  <li>
    Keeping KZSU's staff list private - instead of shared with ex-KZSUers from the past decade, including those kicked out.
  </li>
</ul>
<h1>
  <a id=Background_1717556386720389_93_9973794433753937 name=Background_1717556386720389_93_9973794433753937></a>Background
</h1>
<div>
  <i>Provide any contextual, background information needed to understand the issues at play in this document. You can reference other, existing works, but don't try to explain your project in this section.</i>
</div>
<br>
<div>
  Existing KZSU assets - /internal, zookeeper, podkeeper (used by computing for version control and bug tracking), and Google Apps - have different login mechanisms and, therefore, different credentials, databases, and backend implementations.
</div>
<br>
<h2>
  <a id=Frontend_Perspective_1638515768572688 name=Frontend_Perspective_1638515768572688></a><b>Frontend Perspective</b>
</h2>
<div>
  When a KZSU member wants to login to internal staff application, then into zookeeper, then into Google Apps to check mail on his/her account he/she would have to do the following:
</div>
<ol>
  <li>
    Go to kzsu.stanford.edu/internal
  </li>
  <li>
    Remember RevAsp username and password
  </li>
  <li>
    Remember internal username and password
  </li>
  <li>
    Enter in username and password for /internal
  </li>
  <li>
    Go to zk.stanford.edu
  </li>
  <li>
    Remember Zookeeper username and password
  </li>
  <li>
    Go to Google Apps
  </li>
  <li>
    Remember username and password for Google
  </li>
</ol>
<div>
  Alternative:
</div>
<ol>
  <li>
    Go to kzsu.stanford.edu/internal
  </li>
  <li>
    Remember SSO username and password
  </li>
  <li>
    Go to Zookeeper
  </li>
  <li>
    Go to Google Apps
  </li>
</ol>
<br>
<h2>
  <a id=Backend_perspective_33480621431954205 name=Backend_perspective_33480621431954205></a><b>Backend perspective</b>
</h2>
<ul>
  <li>
    /internal has several different scripts that handle login slightly differently, while still using the same database. This can make access control a pain and is, overall, very messy.
  </li>
  <li>
    Each of KZSU's assets have a different set of usernames and passwords, which makes associating actions with a single identity nearly impossible
  </li>
</ul>
<h1>
  <a id=Overview_8263451410457492_9812_01892273989506066 name=Overview_8263451410457492_9812_01892273989506066></a>Overview
</h1>
<div>
  <i>One page high-level overview. This should be understandable by a beginner volunteer at the station.</i>
</div>
<i><br>
</i>Under the current system, members of KZSU have a different login for different web applications the station uses. You might be "Foo Bar" for your /internal login, fbar for your ZK login, foob for your SVN account, and foo@kzsu.stanford.edu as your Google Apps account. In the case of the staff list, there is one universal username/password combination which everyone uses to access the staff list. This is very insecure because anyone who has ever been a member of the station under this system, including those who were dismissed or left the station on bad terms, can still view your contact information.<br>
<br>
<div>
  Bah! All of these passwords! How about a solution that just needs one?
</div>
<div>
  Enter the SSO Team.
</div>
<br>
Our goal is to eradicate, unclog, and sanitize the current myriad login systems, funneling them into one.<br>
<br>
<div style=TEXT-ALIGN:center>
  <img src="images/drawing_s5Kbh36ZiSsE2I5oNHLmfMw_210.png">
</div>
<div style=TEXT-ALIGN:center>
  <br>
</div>
<div>
  You will only need one account, instead of up to four, to access all of the important station apps.
</div>
<h1>
  <a id=Existing_Resources_Standards_A name=Existing_Resources_Standards_A></a>Existing Resources, Standards, APIs
</h1>
<div>
  <i>What off-the-shelf components will you be able to use in this project? What published APIs will you reuse, if any?</i>
</div>
<i><br>
</i>
<h2>
  <a id=Technologies_Involved_3511500572785735 name=Technologies_Involved_3511500572785735></a><b>Technologies Involved</b>
</h2>
<ul>
  <li>
    <a href=http://en.wikipedia.org/wiki/Security_Assertion_Markup_Language id=ie7d title="SAML: Security Assertion Markup Language">SAML: Security Assertion Markup Language</a>
  </li>
  <ul>
    <li>
      An XML-based open standard for exchanging <a href=http://en.wikipedia.org/wiki/Authentication id=owu2 title=authentication>authentication</a> and <a href=http://en.wikipedia.org/wiki/Authorization id=d0_: title=authorization>authorization</a> between an identity provider (a producer of assertions) and a service provider (a consumer of assertions).
    </li>
    <li>
      Service Providers:
    </li>
    <ul>
      <li>
        kzsu.stanford.edu, zookeeper, podkeeper, Google Apps, etc.
      </li>
    </ul>
    <li>
      Identity Provider:
    </li>
    <ul>
      <li>
        the SSO login page and underlying username &amp; password store
      </li>
    </ul>
    <li>
      How it works:
    </li>
    <ul>
      <li>
        When you visit any Service Provider (SP), you are redirected to the Identity Provider (IdP) in order to login. Then, the Identity Provider asserts to the SP that you are authenticated. The IdP may also tell the Service Provider about any interesting attributes of the authenticated user.
      </li>
    </ul>
  </ul>
</ul>
<br>
<div id=q_qr style=TEXT-ALIGN:center>
  <a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=dgfm4gkb_5fz8w98gc_b target=_blank><img src="images/dgfm4gkb_5fz8w98gc_b.png" style=HEIGHT:374.912px;WIDTH:500px></a>
</div>
<br>
<br>
<ul>
  <li>
    <a href=http://en.wikipedia.org/wiki/Public_key_infrastructure id=j0jm title="PKI: Public Key Infrastructure.">PKI: Public Key Infrastructure</a>
  </li>
  <ul>
    <li>
      A network of trust.
    </li>
    <li>
      We use PKI because it enables the use of https, a secure means of communicating login information between the Service and Identity providers.
    </li>
    <li>
      One of our secure ops machines will generate a self-signed "signing" certificate, which will be used to generate and sign all of the keys for our Service Providers.
    </li>
    <li>
      How we'd use it:
    </li>
    <ul>
      <li>
        One of our secure ops machines will generate a self-signed "signing" certificate, and will be used to generate all of the keys for our Service Providers.
      </li>
      <li>
        This signing cert will be added to all our macs, and we will provide instructions on how to add this to your web browser's circle of trust
      </li>
      <li>
        We use this signing certificate to validate the rest of the certificates used on all our other machines/sites, such as kzsu, kzsu-live, zk, etc.
      </li>
    </ul>
  </ul>
</ul>
<br>
<br>
<br>
<div id=nzbf style=TEXT-ALIGN:center>
  <a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=dgfm4gkb_6gkk2gmc5_b target=_blank><img src="images/dgfm4gkb_6gkk2gmc5_b.png" style=HEIGHT:230px;WIDTH:500px></a>
</div>
<br>
<br>
<b><br>
</b>
<h2>
  <a id=Existing_Resources_3821999980136752 name=Existing_Resources_3821999980136752></a><b>Existing Resources</b>
</h2>
<ul>
  <li>
    For Implementing the Identity Provider:
  </li>
  <ul>
    <li>
      <a href=http://simplesamlphp.org/docs/1.7/simplesamlphp-idp id=d-rc title=SimpleSAMLphp>SimpleSAMLphp</a>
    </li>
    <ul>
      <li>
        Easiest way to run SAML
      </li>
      <li>
        A PHP script that we can hook into our MySQL database.&nbsp;
      </li>
      <li>
        Advantages:
      </li>
      <ul>
        <li>
          Good documentation
        </li>
        <li>
          "Award-Winning"
        </li>
      </ul>
    </ul>
  </ul>
</ul>
<br>
<div id=u._. style=TEXT-ALIGN:center>
  <a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=dgfm4gkb_8c2vqqjg3_b target=_blank><img src="images/dgfm4gkb_8c2vqqjg3_b.png" style=HEIGHT:287.515px;WIDTH:320px></a>
</div>
<div id=fgou style=TEXT-ALIGN:center>
  <a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=dgfm4gkb_8c2vqqjg3_b target=_blank></a><br>
  <div id=pr_7 style=TEXT-ALIGN:center>
    <a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=dgfm4gkb_8c2vqqjg3_b target=_blank></a><a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=dgfm4gkb_9d4n96hfj_b target=_blank><img src="images/dgfm4gkb_9d4n96hfj_b.png" style=HEIGHT:202.222px;WIDTH:320px></a>
  </div>
  <div id=x1b- style=TEXT-ALIGN:center>
    <br>
  </div>
</div>
<ul>
  <li>
    For Implementing the Service Provider:<br>
  </li>
  <ul>
    <li>
      <a href=http://code.google.com/p/modmellon/ id=i6b6 title=mod_auth_mellon>mod_auth_mellon</a>&nbsp;[<a href=http://code.google.com/p/phpmellon/ id=vcze title=2>2</a>]
    </li>
    <ul>
      <li>
        Requirements:
      </li>
      <li>
        OpenSSL
      </li>
      <ul>
        <li>
          lasso
        </li>
      </ul>
      <li>
        Advantages:
      </li>
    </ul>
  </ul>
</ul>
<ul>
  <ul>
    <ul>
      <ul>
        <li>
          Just specify a directory that you want sso to protect
        </li>
        <li>
          From Feide, which also makes SimpleSAMLphp
        </li>
        <li>
          Helpul mailing list
        </li>
      </ul>
      <li>
        Disadvantages:
      </li>
    </ul>
  </ul>
</ul>
<ul>
  <ul>
    <ul>
      <ul>
        <li>
          Sparse documentation
        </li>
      </ul>
    </ul>
    <li>
      <a href=http://www.zxid.org/html/mod_auth_saml.html id=aapt title=mod_auth_saml>mod_auth_saml</a>
    </li>
    <ul>
      <li>
        Advantages:
      </li>
      <ul>
        <li>
          Just specify a directory that you want sso to protect
        </li>
        <ul>
          <li>
            ex: Tell Apache to protect everything under "/internal"<br>
          </li>
        </ul>
      </ul>
      <li>
        Disadvantages:
      </li>
      <ul>
        <li>
          Sparse documentation
        </li>
      </ul>
    </ul>
    <li>
      <a href=http://simplesamlphp.org/docs/1.7/simplesamlphp-sp id=xu:j title=SimpleSAMLPhp>SimpleSAMLphp</a>
    </li>
    <ul>
      <li>
        Advantages:
      </li>
      <ul>
        <li>
          Provided with both IdP and SP functionality<br>
        </li>
      </ul>
      <li>
        Disadvantages:
      </li>
      <ul>
        <li>
          Have to use a php include in all of the relevant files
        </li>
      </ul>
    </ul>
  </ul>
  <ul>
    <li>
      Already packaged for Debian:
    </li>
    <ul>
      <li>
        <a href=http://www.ghacks.net/2009/09/16/create-your-own-certificate-authority-with-tinyca/ id=n0tz title="Tiny CA">Tiny CA</a>
      </li>
      <li>
        <a href=http://www.pyca.de/pyca.html id=qjca title=PyCA>PyCA</a><br>
      </li>
    </ul>
    <li>
      Updated very recently, very sophisticated, but not pre-packaged for Debian:
    </li>
    <ul>
      <li>
        <a href=http://www.openca.org/projects/openca/ id=ouj: title=OpenCA>OpenCA</a><br>
      </li>
    </ul>
  </ul>
  <li>
    For Implementing the certificate signing authority
  </li>
  <ul>
    <li>
      <a href=http://www.openssl.org/ id=pou0 title=OpenSSL>OpenSSL</a>&nbsp;[<a href=http://en.wikipedia.org/wiki/OpenSSL id=lc.5 title=2>2</a>]
    </li>
    <ul>
      <li>
        Advantages:
      </li>
      <ul>
        <li>
          Open and free
        </li>
        <li>
          Actively developed
        </li>
        <li>
          Already installed for SSH
        </li>
      </ul>
      <li>
        Tools to make administering OpenSSL simpler and less error-prone (<font size=2>manage the signing cert, the server certs, and the certificate revocation list)</font>
      </li>
      <ul>
        <li>
          <a href=http://tinyca.sm-zone.net/ id=vs7l title=TinyCA>TinyCA</a>
        </li>
        <ul>
          <li>
            A simple graphical userinterface written in Perl/Gtk to manage a small CA (Certification Authority).
          </li>
          <li>
            TinyCA works as a frontend for openssl
          </li>
        </ul>
      </ul>
    </ul>
  </ul>
</ul>
<h1>
  <a id=Detailed_Design_80067973327822 name=Detailed_Design_80067973327822></a>Detailed Design
</h1>
<div>
  <i>Any non-trivial component, data structure in, and algorithm in the system should be documented here. Graphs of how components/modules interact and what order, may be useful here.</i>
</div>
<i><br>
</i>
<div>
  <b>Before:</b>
</div>
<i><br>
</i>
<div id=tph2 style=TEXT-ALIGN:center>
  <a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=dgfm4gkb_4cxmjdqrn_b target=_blank><img src="images/dgfm4gkb_4cxmjdqrn_b.png" style=WIDTH:100%></a>
</div>
<div id=s40r style=TEXT-ALIGN:center>
  <br>
</div>
<div id=ozqx style=TEXT-ALIGN:left>
  <b>After:</b>
</div>
<div id=ldzo style=TEXT-ALIGN:left>
  <b><br>
  </b>
</div>
<div id=hh85 style=TEXT-ALIGN:left>
  <div id=htok style=TEXT-ALIGN:center>
    <a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=dgfm4gkb_10dmj8nxfq_b target=_blank><img src="images/dgfm4gkb_10dmj8nxfq_b.png" style=WIDTH:100%></a>
  </div>
</div>
<br>
<br>
<ul>
  <li>
    SimpleSAMLphp communicates the attributes of the logged in user to the service provider
  </li>
  <ul>
    <li>
      Example of how we'd use this for access control
    </li>
    <ul>
      <li>
        For Zookeeper we can indicate whether the user can key records
      </li>
      <li>
        For the schedule/studio B signups we can indicate whether they're aircleared and whether they're a schedule admin
      </li>
      <li>
        For the staffing hours app we can indicate what departments they administrate
      </li>
    </ul>
  </ul>
</ul>
<br>
<h1>
  <a id=Project_Information_4506208635 name=Project_Information_4506208635></a>Project Information
</h1>
<i>Who is working on this project? Where is your code located? What email list should people subscribe to, if they want to follow along?</i><br>
<i><br>
<br>
<br>
</i>
<h2>
  <a id=Who_is_working_on_the_project_5034892521798611 name=Who_is_working_on_the_project_5034892521798611></a>Who is working on the project
</h2>
<ul>
  <li>
    Truc Nguyen
  </li>
  <li>
    Nick McGee
  </li>
  <li>
    Brie Bunge
  </li>
</ul>
<h2>
  <a id=Where_the_code_will_be_located_4731373928952962 name=Where_the_code_will_be_located_4731373928952962></a>Where the code will be located
</h2>
<ul>
  <li>
    In the SVN repository on the Podkeeper server
  </li>
  <li>
    URL forthcoming
  </li>
  <li>
    <a href=https://sites.google.com/a/kzsu.stanford.edu/computing/web-sites/sso id=j2am title=Documentation>Documentation</a>
  </li>
</ul>
<h2>
  <a id=Email_list_6867748091463 name=Email_list_6867748091463></a>Email list
</h2>
<ul>
  <li>
    <a href=https://groups.google.com/a/kzsu.stanford.edu/group/sso-team id=fnvn title=sso-team@kzsu.stanford.edu>sso-team@kzsu.stanford.edu</a>
  </li>
</ul>
<h1>
  <a id=UI_Mocks_530787083087489_16353_9052909591700882 name=UI_Mocks_530787083087489_16353_9052909591700882></a><font size=5>UI / Mocks</font>
</h1>
<div>
  <i>We love us some photoshopped screenshots, but nothing too fancy. It can be replaced later with actual screenshots.</i>
</div>
<i><br>
<br>
</i>
<div>
  <i><img src="images/drawing_sMBsHGHdGrWY4hVF7o7_V6w_124.png"><br>
  </i>
</div>
<i><br>
</i>
<div>
  <img src="images/drawing_shLbYUHzM37k5AM-Ui42mcQ_96.png">
</div>
<i><br>
</i>
<div id=f3an style=TEXT-ALIGN:left>
  <a href=http://docs.google.com/a/kzsu.stanford.edu/File?id=df8rcks_23fdgr2js6_b target=_blank><img src="images/df8rcks_23fdgr2js6_b.png" style=HEIGHT:367.204px;WIDTH:600px></a>
</div>
<br>
<div style=TEXT-ALIGN:center>
  <i><br>
  </i>
</div>
<h1>
  <a id=Testing_Plan_2774864013772458__7110875067301095 name=Testing_Plan_2774864013772458__7110875067301095></a>Testing Plan
</h1>
<i>How will you instrument your components in order to test their functionality? If there are changes that occur in future work, would your tests still be able to verify the base functionality?</i><br>
<br>
<ul>
  <li>
    General Development Environment
  </li>
  <ul>
    <li>
      <i><span style=FONT-STYLE:normal>Create a separate subdirectory (ex: /internal-secret) in the sandbox that uses sso for login. This will keep the current login system in an editable state. This is helpful if a bug arises in the current code - it can be fixed much more easily than if the new system were to be developed on top of the current code base, rather than isolated from it.</span></i>
    </li>
    <li>
      <i><span style=FONT-STYLE:normal>Set up a test SAML identity provider and assert that it issues a correct response when logging in from a service provider</span></i>
    </li>
  </ul>
  <li>
    Access Control Lists
  </li>
  <ul>
    <li>
      <i><span style=FONT-STYLE:normal>Create dummy accounts with different access permissions and verify that the appropriate parts of the site (programmatic implementation)</span></i>
    </li>
  </ul>
  <li>
    Verify that certain urls are walled off (correct apache configurations)
  </li>
  <li>
    Verify account creation works as expected
  </li>
</ul>
<h1>
  <a id=Monitoring_5899063085671514_51_3189953579567373 name=Monitoring_5899063085671514_51_3189953579567373></a>Monitoring
</h1>
<div>
  <i>How will your new creation be monitored? How much monitoring will it need? What are some black box tests that can be added to Nagios? Can you create a whitebox interface to expose some monitoring information to collectd or Nagios?</i>
</div>
<div class=kl dir=ltr id=yfjd style=TEXT-ALIGN:left>
  <i><br>
  </i>
</div>
<div class=kl dir=ltr id=hft8 style=TEXT-ALIGN:left>
  <i><span style=FONT-STYLE:normal>We will set up a test account that will always exist for the purposes of testing and monitoring.&nbsp;</span></i>A blackbox test could test to see if the IdP is up and use a login script to programatically attempt&nbsp;<i><span style=FONT-STYLE:normal>to login from all access points and alert when it fails to login with the test account.&nbsp;&nbsp;</span></i>
</div>
<h1>
  <a id=Caveats_15509056905284524_9073_2750521623529494 name=Caveats_15509056905284524_9073_2750521623529494></a>Caveats
</h1>
<i>Why wouldn't simpler solutions be adequate? What other complications can you forsee?&nbsp;</i><br>
<i><br>
</i>
<ul>
  <li>
    <i><font size=2><font style=BACKGROUND-COLOR:#ffffff>The SSO could introduce a single point of failure (SPOF). What happens if the IdP is down?</font></font></i>
  </li>
  <ul>
    <li>
      We will prepare a document outlining procedures to follow in case of an outage. We will encode a backup .htpassword file on each of the servers housing the service provides (except for ZK) which contains the configurations for basic auth so sysadmins can log in case the login page goes down.
    </li>
    <li>
      Also, there is a way to specify multiple identity providers for a service provider. We could set up an alternate identity provider to use when the main one fails.
    </li>
  </ul>
</ul>
<br>
<ul>
  <li>
    <i>How can a newly created user set their password if the password setting script, which is currently located in /internal, is SSO protected?</i>
  </li>
  <ul>
    <li>
      For newly created users, we will give them a default password and will prompt them to change it when they log in.
    </li>
  </ul>
</ul>
<div>
  <br>
  <ul>
    <li>
      <i>What will happen when users forget their password?</i>
    </li>
    <ul>
      <li>
        We can require users to set a "security question" when switching over to SSO, which they will have to answer correctly to reset their password (we will write a script to enable that they can do this themselves).
      </li>
      <li>
        Another option could be sending a special reset link over email.
      </li>
      <li>
        The simplest way would just be to have a account password administrator that takes care&nbsp;
      </li>
    </ul>
  </ul>
  <h2>
    <a id=Possible_alternative_solutions_6426903980318457 name=Possible_alternative_solutions_6426903980318457></a>Possible alternative solutions
  </h2>
  <ul>
    <li>
      More secure and easier desktop integration, but more complicated:
    </li>
    <ul>
      <li>
        [Kerberos and/or LDAP]+SAML: this is still possible as a future improvement
      </li>
      <li>
        [Kerberos and/or LDAP]+WebAuth: would not be a clear upgrade path from SAML alone
      </li>
    </ul>
  </ul>
  <h1>
    <a id=Work_Estimates_098250156966969 name=Work_Estimates_098250156966969></a><font size=5>Work Estimates</font>
  </h1>
  <p>
    <i>If a student were working on this "full time", how much time would you estimate it would take to complete? Note that most KZSU projects are not normally worked on full time.</i>
  </p>
  <br>
  <font size=2>We anticipate that a lot of the time we will be spending on the project will be reading documentation and hands-on learning in the test environment. We estimate that it will take about 75-100 person hours depending on the division of labor and planning to complete the project. It is a realistic to finish the project before the spring 2011 schedule comes out.</font>
</div>
<div>
  <font size=2><br>
  Timeline</font>
</div>
<div>
  <font size=2>Configuring the Certificate Authority:</font><font size=2>&nbsp;5 people hours</font>
</div>
<div>
  <font size=2>Configuring an Identity Provider: 15 people hours</font>
</div>
<div>
  <font size=2>C</font><font size=2>onfiguring a test SP: 10 people hours</font>
</div>
<div>
  <font size=2>Retrofitting the login c</font><font size=2>ode in /internal: 25 people hours&nbsp;</font>
</div>
<div>
  <font size=2>Writing blackbox test code: 10 people hours</font>
</div>
<div>
  <font size=2>Deploying to all SPs: 20 people hours</font>
</div>
<div>
  <font size=2><br>
  (Budgeting in reading time)&nbsp;</font>
</div>
<h1>
  <a id=Launch_Plans_7571198488585651__6688848624471575 name=Launch_Plans_7571198488585651__6688848624471575></a>Launch Plans
</h1>
<i>How will your project be deployed to the KZSU production equipment? What documentation will you provide and what outreach, if any, to KZSU users, will you provide?</i><br>
<br>
<ul>
  <li>
    In the sandbox environment, we can unify login code for all applications we control. This change can be rolled out before we start implementing anything specific to SSO.
  </li>
  <li>
    Deploy PKI
  </li>
  <li>
    Deploy SimpleSAMLPHP for a test instance in a sandbox of the website
  </li>
  <li>
    We will set up some sort of Apache module (mod_mellon or mod_auth_saml) to handle SAML for internal apps, SVN server and (get Jim Mason to do it for) Zookeeper.&nbsp;
  </li>
  <li>
    Turn on SAML auth for test.kzsu.fm in Google Apps
  </li>
  <li>
    Roll out slowly, carefully to everything.
  </li>
</ul>
<br>
<div>
  In preparation for making the switch, we will email current staff members to inform of the changes and ask them what their desired unique username should be. We will also force people to change their password if they do not currently have one or have a sketchy password hash. We will also contact inactive members to tell them that they will no longer be able to access KZSU's internal apps unless they get their station clearance reinstated by the CA/GM.<br>
</div>
<br>
<div>
  In particular, we will provide a layman explanation of the changes that will occur, including only the relevant user-facing information in a step-by-step guide. The guide will clearly outline actions that users must clearly outlined with appropriate visual aids as necessary. We will also announce the change during a staff meeting and hold office hours for those who wish to consult with us in a face-to-face setting.
</div>
<h1>
  <a id=Future_Extension_Ideas_3603024 name=Future_Extension_Ideas_3603024></a><font size=5>Future Extension Ideas</font>
</h1>
<ul>
  <li>
    <font size=2>Automatically nag inactive users and delete old accounts after a certain threshold of inactivity</font>
  </li>
  <li>
    <font size=2>Switch to Kerberos because it has good integration with the Macs at the station (for desktop login) and servers (<font size=2>Kerberized sshd) and</font>&nbsp;very secure</font>
  </li>
</ul>
<h1>
  <a id=References_3130921598058194_75_5179974548518658 name=References_3130921598058194_75_5179974548518658></a><font size=5>References</font>
</h1>
<ul>
  <li>
    The <a href=http://docs.google.com/a/kzsu.stanford.edu/View?docid=df83g6xs_61df4jhdcr id=aak6 title="awesome presentation">awesome presentation</a> created by Brennan Saeta and Andrew Widdowson
  </li>
  <li>
    Wikipedia <a href=http://en.wikipedia.org/wiki/Single_sign-on id=q6ua title=article>article</a> on SSO
  </li>
</ul>
<br>
<br>
<br>
<br></body>
</html>